# CardiacZ: An Intelligent Cardiac Analysis System Using a Hybrid AI Model
---

### **ภาพรวมโครงการ (Project Overview)**

**CardiacZ** คือนวัตกรรมด้านสุขภาพที่ถูกพัฒนาขึ้นเพื่อตอบสนองต่อวิกฤตการณ์ด้านสาธารณสุขในประเทศไทย ซึ่งมีอัตราการเสียชีวิตจากโรคหัวใจและหลอดเลือดสูงถึงเฉลี่ย 5 คนต่อชั่วโมงในปี พ.ศ. 2566 โครงการนี้มีเป้าหมายหลักเพื่อใช้ประโยชน์จากปัญญาประดิษฐ์ (AI) ในการสร้างเครื่องมือวิเคราะห์สุขภาพหัวใจที่มีความแม่นยำสูง เข้าถึงได้ง่าย และมีราคาไม่แพง เพื่อช่วยให้เกิดการ **ตรวจจับโรคตั้งแต่ระยะเริ่มต้น** และลดการเสียชีวิตก่อนวัยอันควร CardiacZ ไม่เพียงแต่ช่วยผู้ป่วยให้ได้รับการรักษาที่ทันท่วงทีเท่านั้น แต่ยังช่วย **ลดภาระงานของบุคลากรทางการแพทย์** ด้วยการทำหน้าที่เป็นระบบคัดกรองเบื้องต้นที่มีประสิทธิภาพ

---

### **รายละเอียดทางเทคนิค (Technical Breakdown)**

หัวใจสำคัญของระบบ CardiacZ คือสถาปัตยกรรม AI ที่ซับซ้อนและผสานการทำงานของโมเดลหลายประเภทเข้าด้วยกันเพื่อความแม่นยำสูงสุด

#### **1. เทคนิคการสร้างโมเดล AI (AI Model Techniques)**

* **โมเดล AI แบบผสมผสาน (Ensemble Model):**
    * เป็นแกนหลักของการวิเคราะห์ที่รวมเอาโมเดล AI หลายตัวมาทำงานร่วมกันในลักษณะ **Ensemble Learning** เพื่อเพิ่มประสิทธิภาพและลดข้อผิดพลาดในการวิเคราะห์ โดยเฉพาะเมื่อสัญญาณ ECG มีสัญญาณรบกวน (noise) สูง
    * ประกอบด้วยโมเดลหลักสองกลุ่มที่ทำงานเสริมกัน:
        * **Convolutional Neural Network (CNN):** เราใช้โมเดล CNN ที่ทันสมัย เช่น **GoogleNet**, **VGG-19**, และ **ResNet-101** ซึ่งมีความเชี่ยวชาญในการวิเคราะห์ภาพ โดยจะทำการแปลงข้อมูลสัญญาณ ECG ให้เป็นภาพก่อน เพื่อให้สามารถสกัดคุณลักษณะ (Feature Extraction) สำคัญ เช่น รูปแบบของ P-Wave, QRS Complex และ T-Wave ที่บ่งชี้ถึงความผิดปกติได้อย่างแม่นยำ
        * **Long Short-Term Memory (LSTM):** โมเดลนี้ถูกออกแบบมาเพื่อจัดการกับข้อมูลที่มีลำดับเวลา (Sequential Data) ได้ดี จึงเหมาะอย่างยิ่งสำหรับวิเคราะห์สัญญาณ ECG ที่มีความต่อเนื่อง เพื่อตรวจจับรูปแบบการเต้นของหัวใจที่ผิดปกติอย่างต่อเนื่องกันตามเวลา (Temporal Features)

* **โมเดลภาษาขนาดใหญ่ (Large Language Model - LLM):**
    * ระบบใช้ **MedGemma-4b-it** ซึ่งเป็นโมเดล LLM ที่ได้รับการปรับแต่งมาโดยเฉพาะสำหรับงานด้านการแพทย์ เพื่อทำหน้าที่เป็นส่วน "Chat" ที่มีประสิทธิภาพสูง
    * MedGemma จะรับผลลัพธ์จากการวิเคราะห์ของ Ensemble Model มาประกอบกับข้อมูลจากผู้ใช้เพื่อทำการ **จำแนกประเภทของโรคหัวใจ (Heart Disease Classification)** และสร้างคำแนะนำด้านสุขภาพที่เป็นประโยชน์ (Health Recommendation) ในรูปแบบภาษาที่เป็นธรรมชาติและเข้าใจง่าย

#### **2. กระบวนการทำงานของระบบ (System Pipeline)**

กระบวนการทำงานของ CardiacZ ถูกออกแบบมาเป็นระบบที่ครบวงจรและอัตโนมัติ ตั้งแต่การรับข้อมูลจนถึงการให้คำแนะนำแก่ผู้ใช้ โดยมีขั้นตอนดังนี้:

1.  **ECG Signal Data:** ระบบเริ่มต้นจากการรับข้อมูล **สัญญาณคลื่นไฟฟ้าหัวใจ (ECG)** จากอุปกรณ์วัดสัญญาณแบบพกพา ซึ่งสามารถเข้าถึงได้ง่ายและมีราคาไม่แพง
2.  **Preprocessing:** ข้อมูลดิบจะถูกทำความสะอาดและปรับปรุงคุณภาพในขั้นตอนนี้ เพื่อกำจัด **สัญญาณรบกวน** ที่อาจเกิดจากปัจจัยภายนอก รวมถึงการปรับข้อมูลให้เป็นมาตรฐาน (Normalization) เพื่อให้พร้อมสำหรับการวิเคราะห์
3.  **Ensemble Model Analysis:** สัญญาณที่ผ่านการประมวลผลแล้วจะถูกส่งเข้าสู่โมเดล AI แบบผสมผสาน (CNN และ LSTM) เพื่อทำการวิเคราะห์เชิงลึกและระบุความผิดปกติที่อาจเกิดขึ้น
4.  **MedGemma Integration:** ผลลัพธ์จากการวิเคราะห์จะถูกเข้ารหัสเป็น **ECG Encoder Vector** และรวมเข้ากับชุดคำสั่งจากระบบ (System Prompt Vector) จากนั้นจะถูกส่งต่อไปยังโมเดลภาษา MedGemma
5.  **Output & Recommendations:** โมเดล **MedGemma** จะประมวลผลข้อมูลทั้งหมดเพื่อสรุปผลการจำแนกโรคและสร้างคำแนะนำด้านสุขภาพในรูปแบบข้อความที่ชัดเจนและเป็นมิตรกับผู้ใช้

#### **3. ระบบตอบคำถามอัจฉริยะและการสื่อสารด้วยเสียง (Intelligent Q&A and Voice Interface)**
* **ระบบ Text-to-Speech และ Speech-to-Text:**
    * CardiacZ ได้รวมระบบการแปลงข้อความเป็นเสียงและเสียงเป็นข้อความโดยใช้ API ของ AI for Thai เพื่อเพิ่มความสะดวกในการใช้งาน
    * **Text-to-Speech (TTS):** ระบบสามารถแปลงคำแนะนำทางการแพทย์และผลการวิเคราะห์เป็นเสียงพูดภาษาไทยที่ชัดเจนและเป็นธรรมชาติ ช่วยให้ผู้ใช้ที่มีปัญหาในการอ่านหรือผู้สูงอายุสามารถรับฟังข้อมูลได้ง่ายขึ้น
    * **Speech-to-Text (STT)**: ผู้ใช้สามารถสอบถามคำถามเกี่ยวกับสุขภาพหัวใจผ่านการพูดได้โดยตรง ระบบจะแปลงเสียงพูดเป็นข้อความเพื่อประมวลผลต่อไป
* **ระบบตอบคำถามทั่วไปด้านโรคหัวใจด้วย RAG (Retrieval-Augmented Generation):**
    * ระบบมีความสามารถในการตอบคำถามทั่วไปเกี่ยวกับโรคหัวใจและการดูแลสุขภาพผ่านเทคนิค **RAG (Retrieval-Augmented Generation)**
    * **Database คลังข้อมูลความรู้:** ระบบมีฐานข้อมูลความรู้ด้านโรคหัวใจที่ครอบคลุม ซึ่งรวบรวมจากแหล่งข้อมูลทางการแพทย์ที่เชื่อถือได้ เช่น คู่มือการรักษา แนวทางปฏิบัติทางการแพทย์ และงานวิจัยที่เกี่ยวข้อง
    * **Pathumma-LLM Integration:** ระบบใช้โมเดล **Pathumma-llm-text-1.0.0** ผ่าน API จาก **AI for Thai** เพื่อประมวลผลและตอบคำถาม โดยโมเดลนี้ได้รับการปรับแต่งมาสำหรับภาษาไทยโดยเฉพาะ
    * **กระบวนการทำงาน RAG:**
        1. เมื่อผู้ใช้ถามคำถาม ระบบจะค้นหาข้อมูลที่เกี่ยวข้องจากฐานข้อมูลความรู้
        2. ข้อมูลที่ค้นพบจะถูกส่งไปยัง Pathumma-LLM พร้อมกับคำถามของผู้ใช้
        3. โมเดลจะสร้างคำตอบที่แม่นยำและเหมาะสมโดยอิงจากข้อมูลที่ค้นพบ
        4. คำตอบจะถูกส่งกลับในรูปแบบข้อความหรือเสียงตามความต้องการของผู้ใช้

---
